<%@ page import="java.util.ArrayList"%><%@ page import="user.userBean.UserProcessBean"%><%@ page import="book.bookBean.BookProcessBean"%><%@ page import="common.Cnst"%><%@ page import="commonJson.JsonUtil"%><%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%><jsp:useBean id="mng_user_info" scope="session" class="manage.manageLogBean.LoginUserBean" /><!DOCTYPE html><html><head><title>貸出確認画面</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="//cdn.datatables.net/plug-ins/1.10.16/integration/font-awesome/dataTables.fontAwesome.css"><link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"><link rel="stylesheet" href="/libraryWeb/css/bootstrap.min.css"><link rel="stylesheet" href="/libraryWeb/css/dataTables.bootstrap.min.css"><link rel="stylesheet" href="/libraryWeb/css/library.css"><link rel="stylesheet" href="/libraryWeb/css/drawer.min.css"><script src="/libraryWeb/js/jquery-3.1.0.min.js"></script><script src="/libraryWeb/js/drawer.min.js"></script><script src="/libraryWeb/js/iscroll.js"></script><script type="text/javascript" src="/libraryWeb/js/jquery.dataTables.min.js"></script><script type="text/javascript" src="/libraryWeb/js/dataTables.bootstrap.min.js"></script><script type="text/javascript" src="/libraryWeb/js/bootstrap.min.js"></script><script type="text/javascript" src="/libraryWeb/js/library.js"></script></head><body class="drawer drawer--left"> <div class="container-fluid">  <p>図書貸出処理を行います</p>  <table id="book" class="display table table-condensed" cellspacing="0" width="100%">   <thead>    <tr>     <th>ID</th>     <th>タイトル</th>     <th>巻次</th>     <th>著者</th>     <th>出版者</th>     <th>出版年</th>     <th>登録日</th>    </tr>   </thead>  </table>  <button class="btn btn-primary" value="一覧へ戻る" type="button" onClick="history.back()">一覧へ戻る</button>  <p>貸し出すユーザを選んでください</p>  <% @SuppressWarnings("unchecked")  ArrayList<UserProcessBean> userList = (ArrayList<UserProcessBean>) request.getAttribute(Cnst.ATTR_USER_BEAN.strType());  JsonUtil j = new JsonUtil();  String displayInfo = (String) request.getAttribute(Cnst.ATTR_DISPLAY_INFO.strType());  %>  <form id="frm-example" action="../UserProcess" method="get">   <table id="user" class="display table table-condensed" cellspacing="0" width="100%">    <thead>     <tr>      <th>ID</th>      <th>ランク</th>      <th>名前</th>      <th>住所</th>      <th>性別</th>      <th>年齢</th>      <th>登録日</th>     </tr>    </thead>    <tfoot>     <tr>      <th>ID</th>      <th>ランク</th>      <th>名前</th>      <th>住所</th>      <th>性別</th>      <th>年齢</th>      <th>登録日</th>     </tr>    </tfoot>   </table>  </form> </div> <script> // jspからjson形式のユーザ情報を取得 var userInfoJson = <%=j.convert(userList)%>; console.log("userInfoJson:"+userInfoJson); // 画面表示情報 var displayInfo = '<%= displayInfo %>'; // セッションに画面表示情報を格納 window.sessionStorage.setItem('displayInfo', displayInfo); // セッションストレージから図書情報を取得 var bookInfoJson = window.sessionStorage.getItem('bookInfoJson'); //bookInfoJsonオブジェクト変換 bookInfoJson = $.parseJSON(bookInfoJson); console.log(bookInfoJson); //userInfoJsonオブジェクト変換 // tableのDOM要素 var bookTable = null; // tableのDOM要素 var userTable = null; $(document).ready(function (){   console.log('displayInfo:if外'+displayInfo);   // テーブル日本語化   dataTablesLanguage();   if(displayInfo === 'lend_display'){     console.log('displayInfo:if内'+displayInfo);   // フォームのhidden要素にbookidを詰める   bookGetId(bookInfoJson);   // テーブルに図書情報を表示する   bookTable = bookListdataTablesShow(bookInfoJson);   // テーブルにユーザの情報を表示する   userTable = userListdataTablesShow(userInfoJson);   tableRelatedFunctionCall(userTable, displayInfo);   } }); $(function () {   $('[data-toggle="popover"]').popover(); });</script> <!-- モーダル・ダイアログ --> <div class="modal fade" id="sampleModal" tabindex="-1">  <div class="modal-dialog">   <div class="modal-content">    <div class="modal-header">     <button type="button" class="close" data-dismiss="modal">      <span>×</span>     </button>     <h4 class="modal-title">貸出確認</h4>    </div>    <form id="lend-modal" action="./BookProcess" method="get">     <div class="modal-body">本文</div>     <div class="modal-footer">      <button type="button" class="btn btn-default" data-dismiss="modal">キャンセル</button>      <button type="submit" name="submit" class="btn btn-primary" value="貸出決定">決定</button>      <input type="hidden" name="user_id" />      <input type="hidden" name="book_id" />     </div>    </form>   </div>  </div> </div></body></html>