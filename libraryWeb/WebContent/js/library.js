
///////////////////////////////////
//パラメータ定数
///////////////////////////////////

  /**
   * @パラメータ定数 PARAM_SUBMIT<br>
   *
   * @値 submit
   */
  const PARAM_SUBMIT = "submit";

  /**
   * @パラメータ定数 PARAM_ID<br>
   *
   * @値 id
   */
  const PARAM_ID = "id";

  /**
   * @パラメータ定数 PARAM_PASS<br>
   *
   * @値 pass
   */
  const PARAM_PASS = "pass";

  /**
   * @パラメータ定数 PARAM_LOGIN<br>
   *
   * @値 login
   */
  const PARAM_LOGIN = "login";

  /**
   * @パラメータ定数 PARAM_USER<br>
   *
   * @値 user
   */
  const PARAM_USER = "user";

  /**
   * @パラメータ定数 PARAM_GUEST<br>
   *
   * @値 guest
   */
  const PARAM_GUEST = "guest";

  /**
   * @パラメータ定数 PARAM_SIGNUP<br>
   *
   * @値 signUp
   */
  const PARAM_SIGNUP = "signUp";

  /**
   * @パラメータ定数 PARAM_REGISTE<br>
   *
   * @値 registe
   */
  const PARAM_REGISTE = "registe";

  /**
   * @パラメータ定数 PARAM_REGISTE_ERROR<br>
   *
   * @値 registe_error
   */
  const PARAM_REGISTE_ERROR = "registe_error";

  /**
   * @パラメータ定数 PARAM_DELETE_DISPLAY<br>
   *
   * @値 delete_display
   */
  const PARAM_DELETE_DISPLAY = "delete_display";

  /**
   * @パラメータ定数 PARAM_DELETE_ERROR<br>
   *
   * @値 delete_error
   */
  const PARAM_DELETE_ERROR = "delete_error";

  /**
   * @パラメータ定数 PARAM_RETURN_COMPLETED<br>
   *
   * @値 returnCompleted
   */
  const PARAM_RETURN_COMPLETED = "returnCompleted";

  /**
   * @パラメータ定数 PARAM_RETURN_ERROR<br>
   *
   * @値 returnError
   */
  const PARAM_RETURN_ERROR = "returnError";

  /**
   * @パラメータ定数 PARAM_LEND_ERROR<br>
   *
   * @値 lend_error
   */
  const PARAM_LEND_ERROR = "lend_error";

  /**
   * @パラメータ定数 PARAM_LIST_ONLY_DISPLAY<br>
   *
   * @値 list_only_display
   */
  const PARAM_LIST_ONLY_DISPLAY = "list_only_display";

  /**
   * @パラメータ定数 PARAM_LEND_DISPLAY<br>
   *
   * @値 lend_display
   */
  const PARAM_LEND_DISPLAY = "lend_display";

   /**
   * @パラメータ定数 PARAM_LENDING_WITHIN_DISPLAY<br>
   *
   * @値 lending_within_display
   */
  const PARAM_LENDING_WITHIN_DISPLAY = "lending_within_display";

  /**
   * @パラメータ定数 PARAM_LENDING_EXCESS_PERSON_LIST_DISPLAY<br>
   *
   * @値 lending_excess_person_list_display
   */
  const PARAM_LENDING_EXCESS_PERSON_LIST_DISPLAY = "lending_excess_person_list_display";

  /**
   * @パラメータ定数 PARAM_RANK<br>
   *
   * @値 rank
   */
  const PARAM_RANK = "rank";

  /**
   * @パラメータ定数 PARAM_BOOK_ID<br>
   *
   * @値 bookId
   */
  const PARAM_BOOK_ID = "bookId";

  /**
   * @パラメータ定数 PARAM_USER_ID<br>
   *
   * @値 userId
   */
  const PARAM_USER_ID = "userId";

  /**
   * @パラメータ定数 PARAM_U_ID<br>
   *
   * @値 u_id
   */
  const PARAM_U_ID = "u_id";

  /**
   * @パラメータ定数 PARAM_U_NAME<br>
   *
   * @値 u_name
   */
  const PARAM_U_NAME = "u_name";

  /**
   * @パラメータ定数 PARAM_U_ADDRESS<br>
   *
   * @値 u_address
   */
  const PARAM_U_ADDRESS = "u_address";

  /**
   * @パラメータ定数 PARAM_U_SEX<br>
   *
   * @値 u_sex
   */
  const PARAM_U_SEX = "u_sex";

  /**
   * @パラメータ定数 PARAM_U_PASS<br>
   *
   * @値 u_pass
   */
  const PARAM_U_PASS = "u_pass";

  /**
   * @パラメータ定数 PARAM_U_DATE<br>
   *
   * @値 u_date
   */
  const PARAM_U_DATE = "u_date";

  /**
   * @パラメータ定数 PARAM_U_AGE<br>
   *
   * @値 u_age
   */
  const PARAM_U_AGE = "u_age";

  /**
   * @パラメータ定数 PARAM_B_ID<br>
   *
   * @値 b_id
   */
  const PARAM_B_ID = "b_id";

  /**
   * @パラメータ定数 PARAM_B_TITLE<br>
   *
   * @値 b_title
   */
  const PARAM_B_TITLE = "b_title";

  /**
   * @パラメータ定数 PARAM_B_DATE<br>
   *
   * @値 b_date
   */
  const PARAM_B_DATE = "b_date";

  /**
   * @パラメータ定数 PARAM_LEND_DATE<br>
   *
   * @値 lend_date
   */
  const PARAM_LEND_DATE = "lend_date";

  /**
   * @パラメータ定数 PARAM_RETURN_DATE<br>
   *
   * @値 return_date
   */
  const PARAM_RETURN_DATE = "return_date";

  /**
   * @パラメータ定数 PARAM_B_RANKING<br>
   *
   * @値 b_ranking
   */
  const PARAM_B_RANKING = "b_ranking";

  /**
   * @パラメータ定数 PARAM_LEND_STATUS<br>
   *
   * @値 lend_status
   */
  const PARAM_LEND_STATUS = "lend_status";

  /**
   * @セレクタ定数 PARAM_ID_ACTIVE1<br>
   *
   * @値 #active1
   */
  const PARAM_ID_ACTIVE1 = "#active1";

  /**
   * @セレクタ定数 PARAM_ID_ACTIVE2<br>
   *
   * @値 #active2
   */
  const PARAM_ID_ACTIVE2 = "#active2";

  /**
   * @セレクタ定数 PARAM_ID_ACTIVE3<br>
   *
   * @値 #active3
   */
  const PARAM_ID_ACTIVE3 = "#active3";

  /**
   * @セレクタ定数 PARAM_ID_ACTIVE4<br>
   *
   * @値 #active4
   */
  const PARAM_ID_ACTIVE4 = "#active4";

  /**
   * @セレクタ定数 PARAM_ID_ACTIVE5<br>
   *
   * @値 #active5
   */
  const PARAM_ID_ACTIVE5 = "#active5";

  /**
   * @セレクタ定数 PARAM_ID_ACTIVE6<br>
   *
   * @値 #active6
   */
  const PARAM_ID_ACTIVE6 = "#active6";

///////////////////////////////////
//共通定数
///////////////////////////////////

  /**
   * @共通定数 INT_ZERO<br>
   *
   * @値 0
   */
  const INT_ZERO = 0;
  /**
   * @共通定数 INT_TWO<br>
   *
   * @値 1
   */
  const INT_ONE = 1;
  /**
   * @共通定数 INT_TWO<br>
   *
   * @値 2
   */
  const INT_TWO = 2;
  /**
   * @共通定数 INT_THREE<br>
   *
   * @値 3
   */
  const INT_THREE = 3;

///////////////////////////////////
//グローバル変数
///////////////////////////////////
// インクリメント用
var i = 0;

///////////////////////////////////
//共通
///////////////////////////////////

/**
 * ハンバーガーメニュー表示
 *
 * @memberOf; libraryWeb.js.library.js
 * @param:
 * @returns:void
 */
function dataTablesMenu() {
  $(document).ready(function() {
    $(".drawer").drawer();
  });
}

/**
 * デスクトップ、モバイル画面用のメニューの表示
 *
 * @memberOf; libraryWeb.js.library.js
 * @param:
 * @returns:void
 */
function responsive () {
  $(window).on('load resize', function() {
    var w = $(window).width();
    var x = 768;
    if (w < x) {
      // 画面サイズが768px未満のときの処理
      $(".management-toggle").css("float", "right");
      $("#loginNow").hide();
      $(".menu").hide();
      $("button.drawer-toggle.drawer-hamburger").show();
    } else {
      // それ以外のときの処理
      $("#loginNow").show();
      $(".menu").show();
      $("button.drawer-toggle.drawer-hamburger").hide();
    }
  });

}

/**
 * テーブル日本語化.
 *
 * @memberOf; libraryWeb.js.library.js
 * @param:
 * @returns:void
 */
function dataTablesLanguage(){
  $.extend($.fn.dataTable.defaults,{
    language : {url : "http://cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Japanese.json"}
  });
}

/**
 * テーブル関連機能呼び出し.<br>
 *
 * @memberOf; libraryWeb.js.library.js
 * @param:
 * @returns:void
 */
function tableRelatedFunctionCall(table, displayInfo) {
  // ユーザ一覧,図書一覧,貸出中,貸出画面の場合
  if(displayInfo == PARAM_LIST_ONLY_DISPLAY || displayInfo == PARAM_LEND_DISPLAY
      || displayInfo == PARAM_LENDING_WITHIN_DISPLAY){
    tableRelatedFunction(displayInfo);
  }

}
/**
 * テーブル上で背景色チェンジ,ポップオーバー表示,クリックでモーダル呼び出し.<br>
 *
 * @memberOf; libraryWeb.js.library.js
 * @param:
 * @returns:void
 */
function tableRelatedFunction(displayInfo) {
  var table = null;
  var flg = INT_ZERO;// 分岐フラグ用
  //ユーザ一覧の場合
  if(($("#user").length) && (!$("#book").length) && displayInfo == PARAM_LIST_ONLY_DISPLAY){
    table = $("#user");// テーブルDOM
  }
  //図書一覧の場合
  if(($("#book").length) && (!$("#user").length) && displayInfo == PARAM_LIST_ONLY_DISPLAY){
    flg = INT_ONE;
    table = $("#book");// テーブルDOM
  }
  //貸出確認画面の場合
  if(($("#book").length) && ($("#user").length) && displayInfo == PARAM_LEND_DISPLAY){
    flg = INT_TWO;
    table = $("#user");// テーブルDOM
  }
  //貸出中一覧の場合
  if(($("#lending").length) && (displayInfo == PARAM_LENDING_WITHIN_DISPLAY)){
    flg = INT_THREE;
    table = $("#lending");// テーブルDOM
  }
  // テーブル上で背景色を変える
  $(table).on({"mouseenter": function(){
      $(this).css("cursor", "pointer");
      $(this).css("opacity", "0.5");
    },
    "mouseleave": function(){
      $(this).css("cursor", "normal");
      $(this).css("opacity", "1");
    }
  },'tbody > tr');

  // テーブル上でポップオーバー
  $(table).on({"mouseenter": function(){
    var data = null;
    $(this).attr('title','詳細表示');
    //クリックでモーダル呼び出し
    $(table).on('click','tbody tr',function() {
      data = $.parseJSON($(this).find('input:eq(0)').val());
      // ユーザ一覧,図書一覧,貸出確認,貸出中一覧の場合,モーダル表示
      if((displayInfo == PARAM_LIST_ONLY_DISPLAY) || (displayInfo == PARAM_LEND_DISPLAY)
          || (displayInfo == PARAM_LENDING_WITHIN_DISPLAY)){
        DisplayModal(data,flg);
      }
    });
  },
    "mouseleave": function(){
      // TODO: マウスから離れた場合の処理があれば追加
       //alert("離れた");
    }
  },'tbody > tr');
}
///////////////////////////////////
//USER
///////////////////////////////////

/**
 * アクティブボタン,タイトル,テーブルラベルの切り替え
 *
 * @memberOf; libraryWeb.js.library.js
 * @param:
 * @returns:void
 */
function userActiveDisplayChange(){
  var displayInfo = window.sessionStorage.getItem('displayInfo');
    var thisButton = null; // アクティブボタンセレクタ格納用
    var titleText = ""; //タイトルテキスト
    switch(displayInfo){
    // ユーザ一覧の場合
    case PARAM_LIST_ONLY_DISPLAY :
      thisButton = $(PARAM_ID_ACTIVE1);
      titleText = "ユーザ一覧";
      $("th:eq(0)").text("ID");
      $("th:eq(1)").text("ランク");
      $('#last-tr').find("th:eq(0)").text("ID");
      $('#last-tr').find("th:eq(1)").text("ランク");
      break;

    // 貸出超過者一覧の場合
    case PARAM_LENDING_EXCESS_PERSON_LIST_DISPLAY :
      thisButton = $(PARAM_ID_ACTIVE2);
      break;

    // ユーザランキングの場合
    case PARAM_RANK :
      thisButton = $(PARAM_ID_ACTIVE3);
      break;

    // ユーザ登録の場合
    case PARAM_REGISTE :
      thisButton = $(PARAM_ID_ACTIVE4);
      break;

    // ユーザ削除の場合
    case PARAM_DELETE_DISPLAY :
      thisButton = $(PARAM_ID_ACTIVE5);
      titleText = "ユーザ削除";
      break;

    default :
      break;

    }
    //アクティブクラスを追加
    $(thisButton).toggleClass('active');
    // タイトルテキストを追加
    $("h4.head-margin").html(titleText);
}

/**
 * ユーザリスト画面<br>
 * テーブルにユーザ情報を表示する.<br>
 *
 * @memberOf; libraryWeb.js.library.js<br>
 * @param:json 形式のユーザ情報<br>
 * @returns:void
 */
function userListdataTablesShow(userInfoJson){
  var table = $('#user').DataTable({
    select: true,
    stateSave: true,
    data: userInfoJson,
    columns: [
              { data: null},
              { data: 'userNumLending'},
              { data: 'userName' },
              { data: 'userAddress' },
              { data: 'userSexKbn' },
              { data: 'userAge' },
              { data: 'userRegisteDate' },
             ],
             'columnDefs': [{
               'targets': 0,
               'className': 'sorting',
               'render': function (data, type, full, meta){
                 i++;
                   return '<td tabindex="0" aria-controls="user" rowspan="1" colspan="1" aria-label="ID: activate to sort column ascending">'+data['userId']+'<input type="hidden" name="id[]" value='
                      + $('<div/>').text(JSON.stringify(data)).html() + '></td>';
               }
             }],
             select: {
               style:    'os',
               selector: 'td:first-child'
           },
  'order': [1, 'asc']
 });
  return table;
}

/**
 * ユーザ削除画面<br>
 * テーブルにユーザ情報を表示する.<br>
 *
 * @memberOf; libraryWeb.js.library.js<br>
 * @param:json 形式のユーザ情報<br>
 * @returns:table<br>
 */
function deleteUserListdataTablesShow(userInfoJson){
  var table = $('#user').DataTable({
    stateSave: true,
    data: userInfoJson,
    columns: [
              { data: null },
              { data: 'userId'},
              { data: 'userName' },
              { data: 'userAddress' },
              { data: 'userSexKbn' },
              { data: 'userAge' },
              { data: 'userRegisteDate' },
             ],
    'columnDefs': [{
      'targets': 0,
      'searchable':false,
      'orderable':false,
      'className': 'dt-body-center',
      'render': function (data, type, full, meta){
          return '<input type="checkbox" name="id[]" value='
             + $('<div/>').text(JSON.stringify(data)).html() + '>';
      }
    }],
   'order': [1, 'asc']
  });
  return table;
}

/**
 * Select all押下でチェック,非チェックをする<br>
 *
 * @memberOf: libraryWeb.js.library.js.<br>
 * @param: tableのDOM要素.<br>
 * @returns: void
 */
function dataTableUserCheckAcquisition(table){

  // "Select all"コントロールをクリック
  $('#example-select-all').on('click', function(){
    // Check/uncheck all checkboxes in the table
    var rows = table.rows({ 'search': 'applied' }).nodes();
    $('input[type="checkbox"]', rows).prop('checked', this.checked);
  });

  // 「すべて選択」コントロールの状態を設定するには、チェックボックスをクリックします。
  $('#user tbody').on('change', 'input[type="checkbox"]', function(){
    // チェックボックスがオフの場合
    if(!this.checked){
      var el = $('#example-select-all').get(0);
      // 「すべて選択」コントロールがチェックされ、「不確定」プロパティがある場合
      if(el && el.checked && ('indeterminate' in el)){
         // Set visual state of "Select all" control
         // as 'indeterminate'
         el.indeterminate = true;
      }
    }
  });
}

/**
 * <p>削除確認ボタン押下で現在チェックされている
 * ユーザ情報をJSONに格納し、ページ遷移する。</p>
 *
 * @memberOf; libraryWeb.js.library.js<br>
 * @param : json形式のユーザ情報<br>
 * @returns :  void<br>
 */
function CheckedUserInformation(){
  $('button.deleteChange').on('click', function(e){
    // ボタンにクラスが存在しなければ処理を抜ける。
    if(!$(this).hasClass("btn-danger")){
      return "";
    }
    var form = $('form#frm-example');
    var userInfoJson = "[";
    var isChecked = $(':checkbox[name="id[]"]:checked');
    //画面に表示されているチェックボックスの状態を取得
    $(isChecked).each(function(){
      $(form).append($('<input>').attr('name', this.name).val(this.value));
      userInfoJson += $(this).val() + ",";
    });
    // テーブル内のすべてのチェックボックスを繰り返す
    // 画面に表示されていないチェックボックスの状態を取得
    table.$('input[type="checkbox"]').each(function(){
      // チェックボックスがDOMに存在しない場合
      if(!$.contains(document, this)){
        // チェックボックスがオンの場合
        if(this.checked){
          // 隠し要素を作成する
          $(form).append($('<input>').attr('name', this.name).val(this.value));
          userInfoJson += $(this).val() + ",";
        }
      }
    });
    // 最後のカンマを削除する
    userInfoJson = userInfoJson.slice(0,-1);
    // json形式の「]」で閉じる
    userInfoJson += "]";
    if(('sessionStorage' in window) && (window.sessionStorage !== null)) {

      // HTML5：ブラウザのストレージの初期化
      sessionStorage.clear();
      window.sessionStorage.clear();

      // sessionStorageにユーザ情報を格納
      window.sessionStorage.setItem('userInfoJson', userInfoJson);

      } else {
    // TODO:ブラウザのストレージが使えない場合の対処
      alert("ブラウザのストレージが非対応っぽい。。。");
  }
    // 削除確認画面遷移
    window.location.href = '/libraryWeb/user/userDeleteConfirm.jsp';
  });
}

/**
 * modalで詳細を表示する.<br>
 *
 * @memberOf; libraryWeb.js.library.js
 * @param:
 * @returns:void
 */
function DisplayModal(data, flg) {
  var html = null;
  var body = $('.modal-body');
  html = ModalHTMLGeneration(flg);

  $(body).appendTo('.modal-body').html(html);
  var size = Object.keys(data).length;
  SetParameterModal(data, flg);
     console.log( data);
  $('#sampleModal').modal();
}

/**
 * @概要: チェックされたIDを取得<br>
 * @memberOf: libraryWeb.js.library.js<br>
 * @param:
 * @returns:void<br>
 */
function checkedGetIdCnt(jsonString, list) {
  var select = $('.label_checkbox');
  jsonString = jsonString.slice(0, -1);
  jsonString += "}";
  //console.log(jsonString);
  $('input[id="check1000"]').prop("checked", true);

  $(select).click(function() {
    var select = $(this).children('.check_select').is(':checked');
    if (select) {
      //console.log('true' + $(this).children('.check_select').val());
    } else {
      //console.log('else' + $(this).children('.check_select').val());
    }
  });
}

/**
 * @概要 チェック数が1つでもあれば削除確認ボタンを表示.
 * @memberOf: libraryWeb.js.library.js
 * @param:
 * @returns:void
 */
function checkIsCntBtnShow(table) {
  $('#user,#book').on('change', 'input[type="checkbox"]', function(){

    var form = $('#frm-example');//フォームDOM
    var deleteChange = $('.deleteChange');// ユーザ削除ボタンDOM
    var isChecked = $(':checkbox[name="id[]"]:checked');// チェックされたDOM
    var classSelect = $('.deleteChange');// 削除確認ボタンDOM
    var colSm6 = $('div.col-sm-6');
    var colSm4 = $('div.col-sm-4');
    var row = $("div.row:nth-child(1)");// テーブルDOM
    // 削除確認ボタン用
    var html = '<div class="col-sm-4 check-count">'
               +'<div id="example_filter" class="dataTables_filter">'
                +'<h3 style="margin-top:0px;">'
                 +'<span class="label label-info glyphicon glyphicon-ok" aria-hidden="true"" name = "name-check-count">'
                 +'</span>'
                +'</h3>'
               +'</div>'
              +'</div>';

    //画面内の表示されているチェックの数
    var DisplayedCheckCount = $(':checkbox[name="id[]"]:checked').length;
    var NotDisplayedCheckCount = 0; // 画面外の表示されていないチェックのカウント用
    var totalCount; //画面内,画面外の合計チェックのカウント用

    //画面に表示されているチェックボックスがあるなら
    $(isChecked).each(function(){
      // 削除確認ボタンに切り替える
      $(deleteChange).toggleClass("btn-primary").addClass("btn-danger");
      $('.btn-danger').css("margin-top", "10px").css("margin-left", "10px");
      $(deleteChange).text("削除確認へ");
      $(deleteChange).parent().removeAttr('href');
      //console.log(DisplayedCheckCount + "DisplayedCheckCount");
    });
    // 画面に表示されていないチェックボックスの状態
    table.$('input[type="checkbox"]').each(function(){
      // チェックボックスがDOMに存在しない場合
      if(!$.contains(document, this)){
        // チェックボックスがオンの場合
        if(this.checked){

          // チェックボックスがオンの場合にカウントする
          NotDisplayedCheckCount++;
          // 削除確認ボタンに切り替える
          $(deleteChange).toggleClass("btn-primary").addClass("btn-danger");
          $('.btn-danger').css("margin-top", "10px").css("margin-left", "10px");
          $(deleteChange).text("削除確認へ");
          $(deleteChange).parent().removeAttr('href');
          // 数値に変換できないオブジェクトを渡した場合
          if(isNaN (NotDisplayedCheckCount)){
            throw Error("エラー：NotDisplayedCheckCount//NaN");
          }
        }
      }
      //console.log(NotDisplayedCheckCount + "NotDisplayedCheckCount");
    });

    var totalCount = DisplayedCheckCount + NotDisplayedCheckCount;
    // チェックが一つもない場合
    if((totalCount) == 0){
      // チェック件数を非表示
      $(colSm4).toggleClass("col-sm-6").toggleClass("col-sm-4");
      $('.check-count').hide();
      // ボタンを切り替える
      $(classSelect).addClass("btn-primary").toggleClass("btn-danger");
      $(classSelect).text("ユーザ削除");
      $(classSelect).parent().attr('href', 'ManagementMenu?submit=ユーザ削除');
    }else{
      // チェック件数を表示
      $(colSm6).toggleClass("col-sm-4").toggleClass("col-sm-6");
      if(totalCount == 0 || ($('.check-count').length == 0)){
        var tmp = $(row).append(html);
        $("span[name='name-check-count']").text(totalCount);
      }else if($('.check-count').css('display') == 'none'){
        $('.check-count').show();
     }
    }
    $("span[name='name-check-count']").text(" " +  totalCount);
  });
}

/**
 * 単一、複数のIDを返す.
 *
 * @memberOf: libraryWeb.js.library.js
 * @param: userInfoJson
 * @returns: void
 */
function userGetId(userInfoJson){
    var userIdList = [];
    for (var item in userInfoJson) {
     item + ': ' + userInfoJson[item]['userId'];
     userIdList.push(userInfoJson[item]['userId']);
   }
    //console.log("yes"+ userIdList);
    $("[name='user_id']").attr("value", userIdList);
    window.sessionStorage.setItem('userIdList', userIdList);
    return userIdList;
    //console.log("no"+ userIdList);
}

///////////////////////////////////
//BOOK
///////////////////////////////////
/**
 * 図書リスト画面<br>
 * テーブルに図書情報を表示する.<br>
 *
 * @memberOf; libraryWeb.js.library.js<br>
 * @param:json 形式の図書情報<br>
 * @returns:void
 */
function bookListdataTablesShow(bookInfoJson){
  i = 0;
  var table = $('#book').DataTable(
   {
    select: true,
    stateSave: true,
    data: bookInfoJson,
    columns: [
              { data: null},
              { data: 'bookNumLending'},
              { data: 'title'},
              { data: 'author' },
              { data: 'publisher' },
              { data: 'yearPublication' },
              { data: 'bookRegisteDate' },
             ],
             'columnDefs': [{
               'targets': 0,
               'className': 'sorting',
               'render': function (data, type, full, meta){
                 i++;
                   return '<td tabindex="0" aria-controls="book" rowspan="1" colspan="1" aria-label="ID: activate to sort column ascending">'+data['bookId']+'<input type="hidden" name="id[]" value='
                      + $('<div/>').text(JSON.stringify(data)).html() + '></td>';
               }
             }],
             select: {
               style:    'os',
               selector: 'td:first-child'
           },
   'order': [1, 'asc']
  });
  return table;
}

/**
 * 貸出中画面<br>
 * テーブルに貸出中情報を表示する.<br>
 *
 * @memberOf; libraryWeb.js.library.js<br>
 * @param:json 形式の貸出中情報情報<br>
 * @returns:void
 */
function lendingListdataTablesShow(lendingInfoJson){
  i = 0;
  var table = $('#lending').DataTable(
   {
    select: true,
    stateSave: true,
    data: lendingInfoJson,
    columns: [
              { data: null},
              { data: 'title'},
              { data: 'userId' },
              { data: 'userName' },
              { data: 'lendingDate' },
              { data: 'returnDate' },
             ],
             'columnDefs': [{
               'targets': 0,
               'className': 'sorting',
               'render': function (data, type, full, meta){
                 i++;
                   return '<td tabindex="0" aria-controls="lending" rowspan="1" colspan="1" aria-label="ID: activate to sort column ascending">'+data['bookId']+'<input type="hidden" name="id[]" value='
                      + $('<div/>').text(JSON.stringify(data)).html() + '></td>';
               }
             }],
             select: {
               style:    'os',
               selector: 'td:first-child'
           },
   'order': [1, 'asc']
  });
  return table;
}

/**
 * 図書削除画面<br>
 * テーブルに図書情報を表示する.<br>
 *
 * @memberOf; libraryWeb.js.library.js<br>
 * @param:json 形式の図書情報<br>
 * @returns:table<br>
 */
function deleteBookListdataTablesShow(bookInfoJson){
  var table = $('#book').DataTable({
    stateSave: true,
    data: bookInfoJson,
    columns: [
              { data: null },
              { data: 'bookId'},
              { data: 'title'},
              { data: 'author' },
              { data: 'publisher' },
              { data: 'yearPublication' },
              { data: 'bookRegisteDate' },
             ],
    'columnDefs': [{
      'targets': 0,
      'searchable':false,
      'orderable':false,
      'className': 'dt-body-center',
      'render': function (data, type, full, meta){
          return '<input type="checkbox" name="id[]" value='
             + $('<div/>').text(JSON.stringify(data)).html() + '>';
      }
    }],
   'order': [1, 'asc']
  });
  return table;
}

/**
 * Select all押下でチェック,非チェックをする<br>
 *
 * @memberOf: libraryWeb.js.library.js.<br>
 * @param: tableのDOM要素.<br>
 * @returns: void
 */
function dataTableBookCheckAcquisition(table){

  // "Select all"コントロールをクリック
  $('#example-select-all').on('click', function(){
    // Check/uncheck all checkboxes in the table
    var rows = table.rows({ 'search': 'applied' }).nodes();
    $('input[type="checkbox"]', rows).prop('checked', this.checked);
  });

  // 「すべて選択」コントロールの状態を設定するには、チェックボックスをクリックします。
  $('#book tbody').on('change', 'input[type="checkbox"]', function(){
    // チェックボックスがオフの場合
    if(!this.checked){
      var el = $('#example-select-all').get(0);
      // 「すべて選択」コントロールがチェックされ、「不確定」プロパティがある場合
      if(el && el.checked && ('indeterminate' in el)){
         // Set visual state of "Select all" control
         // as 'indeterminate'
         el.indeterminate = true;
      }
    }
  });
}

/**
 * アクティブボタン,タイトル,テーブルラベルの切り替え
 *
 * @memberOf; libraryWeb.js.library.js
 * @param:
 * @returns:void
 */
function bookActiveDisplayChange(){
  var displayInfo = window.sessionStorage.getItem('displayInfo');
    var thisButton = null; // アクティブボタンセレクタ格納用
    var titleText = ""; //タイトルテキスト
    switch(displayInfo){
    // 図書一覧画面の場合
    case PARAM_LIST_ONLY_DISPLAY :
      thisButton = $(PARAM_ID_ACTIVE1);
      titleText = "図書一覧";

      $("th:eq(0)").text("ID");
      $("th:eq(1)").text("ランク");
      $('#last-tr').find("th:eq(0)").text("ID");
      $('#last-tr').find("th:eq(1)").text("ランク");
      break;

   // 図書貸出の場合
   case PARAM_LEND_DISPLAY :
      thisButton = $(PARAM_ID_ACTIVE2);
      titleText = "貸出一覧";
      break;

    // 貸出中一覧の場合
    case PARAM_LENDING_WITHIN_DISPLAY :
      thisButton = $(PARAM_ID_ACTIVE3);
      titleText = "貸出中図書一覧";
      break;

    // ブックランキングの場合
    case PARAM_RANK :
      thisButton = $(PARAM_ID_ACTIVE4);
      titleText = "ブックランキング";
     break;

    // 図書登録の場合
    case PARAM_REGISTE :
      thisButton = $(PARAM_ID_ACTIVE5);
      titleText = "図書登録";
      break;

    // 図書削除一覧の場合
    case PARAM_DELETE_DISPLAY :
      thisButton = $(PARAM_ID_ACTIVE6);
      titleText = "図書削除一覧";
      break;

    default :
      break;

    }
    //アクティブクラスを追加
    $(thisButton).toggleClass('active');
    // タイトルテキストを追加
    $("h4.head-margin").html(titleText);
}

/**
 * <p>削除確認ボタン押下で現在チェックされている
 * 図書情報をJSONに格納し、ページ遷移する。</p>
 *
 * @memberOf; libraryWeb.js.library.js<br>
 * @param : json形式の図書情報<br>
 * @returns :  void<br>
 */
function CheckedBookInformation(){
  $('button.deleteChange').on('click', function(e){
    // ボタンにクラスが存在しなければ処理を抜ける。
    if(!$(this).hasClass("btn-danger")){
      return "";
    }
    var form = $('form#frm-example');
    var bookInfoJson = "[";
    var isChecked = $(':checkbox[name="id[]"]:checked');
    //画面に表示されているチェックボックスの状態を取得
    $(isChecked).each(function(){
      $(form).append($('<input>').attr('name', this.name).val(this.value));
      bookInfoJson += $(this).val() + ",";
    });
    // テーブル内のすべてのチェックボックスを繰り返す
    // 画面に表示されていないチェックボックスの状態を取得
    table.$('input[type="checkbox"]').each(function(){
      // チェックボックスがDOMに存在しない場合
      if(!$.contains(document, this)){
        // チェックボックスがオンの場合
        if(this.checked){
          // 隠し要素を作成する
          $(form).append($('<input>').attr('name', this.name).val(this.value));
          bookInfoJson += $(this).val() + ",";
        }
      }
    });
    // 最後のカンマを削除する
    bookInfoJson = bookInfoJson.slice(0,-1);
    // json形式の「]」で閉じる
    bookInfoJson += "]";
    if(('sessionStorage' in window) && (window.sessionStorage !== null)) {

      // HTML5：ブラウザのストレージの初期化
      sessionStorage.clear();
      window.sessionStorage.clear();

      // sessionStorageに図書情報を格納
      window.sessionStorage.setItem('bookInfoJson', bookInfoJson);

      } else {
    // TODO:ブラウザのストレージが使えない場合の対処
    alert("ブラウザのストレージが非対応っぽい。。。");
  }
    // 削除確認画面遷移
    window.location.href = '/libraryWeb/book/bookDeleteConfirm.jsp';
  });
}

/**
 * <p>貸出確認ボタン押下で現在チェックされている
 * 図書情報をJSONに格納し、ページ遷移する。</p>
 *
 * @memberOf; libraryWeb.js.library.js<br>
 * @param : json形式の図書情報<br>
 * @returns :  void<br>
 */
function CheckedLendBookInformation(){
  $('button.lendChange').on('click', function(e){
    // ボタンにクラスが存在しなければ処理を抜ける。
    if(!$(this).hasClass("btn-danger")){
      return "";
    }
    var form = $('form#frm-example');
    var bookInfoJson = "[";
    var isChecked = $(':checkbox[name="id[]"]:checked');
    //画面に表示されているチェックボックスの状態を取得
    $(isChecked).each(function(){
      $(form).append($('<input>').attr('name', this.name).val(this.value));
      bookInfoJson += $(this).val() + ",";
    });
    // テーブル内のすべてのチェックボックスを繰り返す
    // 画面に表示されていないチェックボックスの状態を取得
    table.$('input[type="checkbox"]').each(function(){
      // チェックボックスがDOMに存在しない場合
      if(!$.contains(document, this)){
        // チェックボックスがオンの場合
        if(this.checked){
          // 隠し要素を作成する
          $(form).append($('<input>').attr('name', this.name).val(this.value));
          bookInfoJson += $(this).val() + ",";
        }
      }
    });
    // 最後のカンマを削除する
    bookInfoJson = bookInfoJson.slice(0,-1);
    // json形式の「]」で閉じる
    bookInfoJson += "]";

    // HTML5 : ブラウザのストレージが使える場合
    if(('sessionStorage' in window) && (window.sessionStorage !== null)) {

      // sessionStorageの初期化
      sessionStorage.clear();
      window.sessionStorage.clear();

      // sessionStorageに図書情報を格納
      window.sessionStorage.setItem('bookInfoJson', bookInfoJson);

      } else {
    // TODO:ブラウザのストレージが使えない場合の対処
    alert("ブラウザのストレージが非対応っぽい。。。");
  }
    // 画面表示情報
    var displayInfo = '<%= displayInfo %>';
    // セッションに画面表示情報を格納
    window.sessionStorage.setItem('displayInfo', displayInfo);
    // 貸出確認画面遷移
    window.location.href = "./BookProcess?submit=貸出確認";
  });
}

/**
 * 単一、複数のIDを返す.
 *
 * @memberOf: libraryWeb.js.library.js
 * @param: bookInfoJson
 * @returns: void
 */
function bookGetId(bookInfoJson){
    var bookIdList = [];
    for (var item in bookInfoJson) {
     item + ': ' + bookInfoJson[item]['bookId'];
     bookIdList.push(bookInfoJson[item]['bookId']);
   }
    //console.log("yes"+ bookIdList);
    $("[name='book_id']").attr("value", bookIdList);
    window.sessionStorage.setItem('bookIdList', bookIdList);
    return bookIdList;
    //console.log("no"+ bookIdList);

}

/**
 * @概要 チェック数が1つでもあれば貸出確認ボタンを表示.
 * @memberOf: libraryWeb.js.library.js
 * @param:
 * @returns:void
 */
function checkIsCntLendBtnShow(table) {
  $('#book').on('change', 'input[type="checkbox"]', function(){

    var form = $('#frm-example');//フォームDOM
    var lendChange = $('.lendChange');// 図書貸出ボタンDOM
    var isChecked = $(':checkbox[name="id[]"]:checked');// チェックされたDOM
    var classSelect = $('.lendChange');// 貸出確認ボタンDOM
    var colSm6 = $('div.col-sm-6');
    var colSm4 = $('div.col-sm-4');
    var row = $("div.row:nth-child(1)");// テーブルDOM
    // 貸出確認ボタン用
    var html = '<div class="col-sm-4 check-count">'
               +'<div id="example_filter" class="dataTables_filter">'
                +'<h3 style="margin-top:0px;">'
                 +'<span class="label label-info glyphicon glyphicon-ok" aria-hidden="true"" name = "name-check-count">'
                 +'</span>'
                +'</h3>'
               +'</div>'
              +'</div>';

    //画面内の表示されているチェックの数
    var DisplayedCheckCount = $(':checkbox[name="id[]"]:checked').length;
    var NotDisplayedCheckCount = 0; // 画面外の表示されていないチェックのカウント用
    var totalCount; //画面内,画面外の合計チェックのカウント用

    //画面に表示されているチェックボックスがあるなら
    $(isChecked).each(function(){
      // 貸出確認ボタンに切り替える
      $(lendChange).toggleClass("btn-primary").addClass("btn-danger");
      $('.btn-danger').css("margin-top", "10px").css("margin-left", "10px");
      $(lendChange).text("貸出確認へ");
      $(lendChange).parent().removeAttr('href');
      //console.log(DisplayedCheckCount + "DisplayedCheckCount");
    });
    // 画面に表示されていないチェックボックスの状態
    table.$('input[type="checkbox"]').each(function(){
      // チェックボックスがDOMに存在しない場合
      if(!$.contains(document, this)){
        // チェックボックスがオンの場合
        if(this.checked){

          // チェックボックスがオンの場合にカウントする
          NotDisplayedCheckCount++;
          // 貸出確認ボタンに切り替える
          $(lendChange).toggleClass("btn-primary").addClass("btn-danger");
          $('.btn-danger').css("margin-top", "10px").css("margin-left", "10px");
          $(lendChange).text("貸出確認へ");
          $(lendChange).parent().removeAttr('href');
          // 数値に変換できないオブジェクトを渡した場合
          if(isNaN (NotDisplayedCheckCount)){
            throw Error("エラー：NotDisplayedCheckCount//NaN");
          }
        }
      }
      //console.log(NotDisplayedCheckCount + "NotDisplayedCheckCount");
    });

    var totalCount = DisplayedCheckCount + NotDisplayedCheckCount;
    // チェックが一つもない場合
    if((totalCount) == 0){
      // チェック件数を非表示
      $(colSm4).toggleClass("col-sm-6").toggleClass("col-sm-4");
      $('.check-count').hide();
      // ボタンを切り替える
      $(classSelect).addClass("btn-primary").toggleClass("btn-danger");
      $(classSelect).text("図書貸出");
      $(classSelect).parent().attr('href', 'ManagementMenu?submit=図書貸出');
    }else{
      // チェック件数を表示
      $(colSm6).toggleClass("col-sm-4").toggleClass("col-sm-6");
      if(totalCount == 0 || ($('.check-count').length == 0)){
        var tmp = $(row).append(html);
        $("span[name='name-check-count']").text(totalCount);
      }else if($('.check-count').css('display') == 'none'){
        $('.check-count').show();
     }
    }
    $("span[name='name-check-count']").text(" " +  totalCount);
  });
}

/**
 * 貸出確認画面のモーダル表示.<br>
 *
 * @memberOf; libraryWeb.js.library.js
 * @param:
 * @returns:void
 */
function lendingConfirmationScreenPopOverShow() {
  var table = null;
  if($("#user").length){
    table = $("#user");// テーブルDOM
  }

  // テーブルホバーでポップオーバー
  $(table).on({"mouseenter": function(){
    var data = [];
    $(this).attr('title','詳細表示');
    //クリックでモーダル表示
    $(table).on('click','tbody tr',function() {
      data = $.parseJSON($(this).find('input:eq(0)').val());
      // modal呼び出し
      DisplayLendingConfirmationModal(data);
    });
  },
    "mouseleave": function(){
      // TODO: マウスから離れた場合の処理があれば追加
       //alert("離れた");
    }
  },'tbody > tr');
}

/**
 * 貸出確認のmodalを表示する.<br>
 *
 * @memberOf; libraryWeb.js.library.js
 * @param:
 * @returns:void
 */
function DisplayLendingConfirmationModal(data, flg) {
  var html = null;
  // ユーザテーブルがある場合
  if(flg == INT_TWO){
    html = ModalHTMLGeneration(flg);
  }

  var body = $('.modal-body');
  $(body).appendTo('.modal-body').html(html);
  var size = Object.keys(data).length;
  SetParameterModal(data, flg);
    // console.log( data);
  $('#sampleModal').modal();
}

/**
 * モーダルにパラメータをセット.<br>
 *
 * @memberOf; libraryWeb.js.library.js
 * @param:
 * @returns:String
 */
function SetParameterModal(data, flg) {
  var body = $('.modal-body');
  // ユーザ詳細モーダル
  if(flg == INT_ZERO){
    $(body).find('td[name="user-id"]').children().val(data.userId);
    $(body).find('td[name="user-pass"]').children().val(data.userPass);
    $(body).find('td[name="mng-user-id"]').children().val(data.userRegisteDate);
    $(body).find('td[name="user-name"]').children().val(data.userName);
    $(body).find('td[name="user-address"]').children().val(data.userAddress);
    $(body).find('td[name="user-sex-kbn"]').children().val(data.userSexKbn);
    $(body).find('td[name="user-age"]').children().val(data.userAge);
    $(body).find('td[name="user-registe-date"]').children().val(data.userRegisteDate);
  }
  // 図書詳細モーダル
  if(flg == INT_ONE){
    $(body).find('td[name="book-id"]').children().val(data.bookId);
    $(body).find('td[name="title"]').children().val(data.title);
    $(body).find('td[name="winding-next"]').children().val(data.windingNext);
    $(body).find('td[name="series"]').children().val(data.series);
    $(body).find('td[name="version-display"]').children().val(data.versionDisplay);
    $(body).find('td[name="author"]').children().val(data.author);
    $(body).find('td[name="publisher"]').children().val(data.publisher);
    $(body).find('td[name="year-publication"]').children().val(data.yearPublication);
    $(body).find('td[name="isbn"]').children().val(data.isbn);
    $(body).find('td[name="number-pages-h-w"]').children().val(data.numberPagesHW);
    $(body).find('td[name="scope-disclosuer"]').children().val(data.scopeDisclosuer);
    $(body).find('td[name="mng-user-id"]').children().val(data.mngUserId);
    $(body).find('td[name="book-registe-date"]').children().val(data.bookRegisteDate);
  }
  // 貸出確認モーダル
  if(flg == INT_TWO){
    $(body).find('td[name="user-id"]').children().text(data.userId);
    $(body).find('td[name="user-pass"]').children().text(data.userPass);
    $(body).find('td[name="mng-user-id"]').children().text(data.userRegisteDate);
    $(body).find('td[name="user-name"]').children().text(data.userName);
    $(body).find('td[name="user-address"]').children().text(data.userAddress);
    $(body).find('td[name="user-sex-kbn"]').children().text(data.userSexKbn);
    $(body).find('td[name="user-age"]').children().text(data.userAge);
    $(body).find('td[name="user-registe-date"]').children().text(data.userRegisteDate);
    // hiddin要素にパラメータ設定
    $(body).next().find('input[name="user_id"]').val(data.userId);
  }
  // 返却確認モーダル
  if(flg == INT_THREE){
    $(body).find('td[name="book-id"]').children().text(data.bookId);
    $(body).find('td[name="title"]').children().text(data.title);
    $(body).find('td[name="user-id"]').children().text(data.userId);
    $(body).find('td[name="user-name"]').children().text(data.userName);
    $(body).find('td[name="lending-date"]').children().text(data.lendingDate);
    $(body).find('td[name="return-date"]').children().text(data.returnDate);
    // hiddin要素にパラメータ設定
    $(body).next().find('input[name="user_id"]').val(data.userId);
    $(body).next().find('input[name="book_id"]').val(data.bookId);
  }
}
  /**
   * モーダルのHTML生成を行う.<br>
   *
   * @memberOf; libraryWeb.js.library.js
   * @param:
   * @returns:String
   */
  function ModalHTMLGeneration(flg) {
  var htmlGeneration = null;
  // ユーザモーダル
  if(flg == INT_ZERO){
    htmlGeneration = '<div class="">'
      +'<form id="modal-form" action="" method="get">'
       +'<table id="modal-table" class="table">'
        +'<thead>'
         +'<th><label>項目名</label></th>'
         +'<th><label>名称</label></th>'
        +'</thead>'
        +'<tr>'
         +'<th><label>ID</label></th>'
         +'<td name="user-id"><input name="input-modal" type="text"></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>パスワード</label></th>'
         +'<td name="user-pass"><input name="input-modal" type="text"></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>登録管理ユーザ</label></th>'
         +'<td name="mng-user-id"><input name="input-modal" type="text"></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>名前</label></th>'
         +'<td name="user-name"><input name="input-modal" type="text"></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>住所</label></th>'
         +'<td name="user-address"><input name="input-modal" type="text"></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>性別</label></th>'
         +'<td name="user-sex-kbn"><input name="input-modal" type="text"></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>年齢</label></th>'
         +'<td name="user-age"><input name="input-modal" type="text"></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>登録日</label></th>'
         +'<td name="user-registe-date"><input name="input-modal" type="text"></td>'
        +'</tr>'
       +'</table>'
      +'</form>'
     +'</div>';
    return htmlGeneration;
  }
  // 図書モーダル
  if(flg == INT_ONE){
    htmlGeneration ='<div class="table-responsive">'
      +'<form id="modal-form" action="" method="get">'
      +'<table id="modal-table" class="table">'
       +'<thead>'
       +'<th><label>項目名</label></th>'
       +'<th><label>名称</label></th>'
       +'</thead>'
       +'<tr>'
        +'<th><label>ID</label></th>'
        +'<td name="book-id"><input name="input-modal" type="text"value=""readonly></td>'
       +'</tr>'
       +'<tr>'
        +'<th><label>タイトル</label></th>'
        +'<td name="title"><input name="input-modal" type="text"></td>'
       +'</tr>'
       +'<tr>'
        +'<th><label>巻次</label></th>'
        +'<td name="winding-next"><input name="input-modal" type="text"></td>'
       +'</tr>'
       +'<tr>'
        +'<th><label>シリーズ</label></th>'
        +'<td name="series"><input name="input-modal" type="text"></td>'
       +'</tr>'
       +'<tr>'
        +'<th><label>版表示</label></th>'
        +'<td name="version-display"><input name="input-modal" type="text"></td>'
       +'</tr>'
       +'<tr>'
        +'<th><label>著者</label></th>'
        +'<td name="author"><input name="input-modal" type="text"></td>'
       +'</tr>'
       +'<tr>'
        +'<th><label>出版者</label></th>'
        +'<td name="publisher"><input name="input-modal" type="text"></td>'
       +'</tr>'
       +'<tr>'
        +'<th><label>出版年</label></th>'
        +'<td name="year-publication"><input name="input-modal" type="text"></td>'
       +'</tr>'
       +'<tr>'
        +'<th><label>図書コード</label></th>'
        +'<td name="isbn"><input name="input-modal" type="text"></td>'
       +'</tr>'
       +'<tr>'
        +'<th><label>冊数（ページ数・大きさ）</label></th>'
        +'<td name="number-pages-h-w"><input name="input-modal" type="text"></td>'
       +'</tr>'
       +'<tr>'
        +'<th><label>公開範囲</label></th>'
        +'<td name="scope-disclosuer"><input name="input-modal" type="text"></td>'
       +'</tr>'
       +'<tr>'
        +'<th><label>登録管理ユーザ</label></th>'
        +'<td name="mng-user-id"><input name="input-modal" type="text"readonly></td>'
       +'</tr>'
        +'<tr>'
         +'<th><label>登録日</label></th>'
         +'<td name="book-registe-date"><input name="input-modal" type="text"readonly></td>'
        +'</tr>'
       +'</table>'
      +'</form>'
      +'</div>';
    return htmlGeneration;
  }
  // 貸出確認モーダル
  if(flg == INT_TWO){
    htmlGeneration = '<div class="">'
      +'<form id="modal-form" action="" method="get">'
       +'<table id="modal-table" class="table">'
       +'<thead>'
       +'<th>こちらのユーザに貸出しますか？</th>'
      +'</thead>'
        +'<tr>'
         +'<th><label>ID</label></th>'
         +'<td name="user-id"><span name="span-modal"></span></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>パスワード</label></th>'
         +'<td name="user-pass"><span name="span-modal"></span></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>登録管理ユーザ</label></th>'
         +'<td name="mng-user-id"><span name="span-modal"></span></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>名前</label></th>'
         +'<td name="user-name"><span name="span-modal"></span></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>住所</label></th>'
         +'<td name="user-address"><span name="span-modal"></span></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>性別</label></th>'
         +'<td name="user-sex-kbn"><span name="span-modal"></span></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>年齢</label></th>'
         +'<td name="user-age"><span name="span-modal"></span></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>登録日</label></th>'
         +'<td name="user-registe-date"><span name="span-modal"></span></td>'
        +'</tr>'
       +'</table>'
      +'</form>'
     +'</div>';
    return htmlGeneration;
  }
  // 返却確認モーダル
  if(flg == INT_THREE){
    htmlGeneration = '<div class="">'
      +'<form id="modal-form" action="" method="get">'
       +'<table id="modal-table" class="table">'
       +'<thead>'
       +'<th>こちらの図書を返却しますか？</th>'
      +'</thead>'
        +'<tr>'
         +'<th><label>図書ID</label></th>'
         +'<td name="book-id"><span name="span-modal"></span></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>タイトル</label></th>'
         +'<td name="title"><span name="span-modal"></span></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>ユーザID</label></th>'
         +'<td name="user-id"><span name="span-modal"></span></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>名前</label></th>'
         +'<td name="user-name"><span name="span-modal"></span></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>貸出日</label></th>'
         +'<td name="lending-date"><span name="span-modal"></span></td>'
        +'</tr>'
        +'<tr>'
         +'<th><label>返却日</label></th>'
         +'<td name="return-date"><span name="span-modal"></span></td>'
        +'</tr>'
       +'</table>'
      +'</form>'
     +'</div>';
    return htmlGeneration;
  }
}